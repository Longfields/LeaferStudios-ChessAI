try{var e,o,t=new Chess,i={wK:"https://upload.wikimedia.org/wikipedia/commons/4/42/Chess_klt45.svg",bK:"https://upload.wikimedia.org/wikipedia/commons/f/f0/Chess_kdt45.svg",wQ:"https://upload.wikimedia.org/wikipedia/commons/1/15/Chess_qlt45.svg",bQ:"https://upload.wikimedia.org/wikipedia/commons/4/47/Chess_qdt45.svg",wR:"https://upload.wikimedia.org/wikipedia/commons/7/72/Chess_rlt45.svg",bR:"https://upload.wikimedia.org/wikipedia/commons/f/ff/Chess_rdt45.svg",wB:"https://upload.wikimedia.org/wikipedia/commons/b/b1/Chess_blt45.svg",bB:"https://upload.wikimedia.org/wikipedia/commons/9/98/Chess_bdt45.svg",wN:"https://upload.wikimedia.org/wikipedia/commons/7/70/Chess_nlt45.svg",bN:"https://upload.wikimedia.org/wikipedia/commons/e/ef/Chess_ndt45.svg",wP:"https://upload.wikimedia.org/wikipedia/commons/4/45/Chess_plt45.svg",bP:"https://upload.wikimedia.org/wikipedia/commons/c/c7/Chess_pdt45.svg"},r=3,n=0,s=function(e,o,t){for(var i,r=o.ugly_moves(),n=-9999,s=0;s<r.length;s++){var _=r[s];o.ugly_move(_);var u=a(e-1,o,-1e4,1e4,!t);o.undo(),u>=n&&(n=u,i=_)}return i},a=function(e,t,i,r,n){if(o++,0===e)return-_(t.board());var s=t.ugly_moves();if(n){for(var u=-9999,p=0;p<s.length&&(t.ugly_move(s[p]),u=Math.max(u,a(e-1,t,i,r,!n)),t.undo(),!(r<=(i=Math.max(i,u))));p++);return u}for(var u=9999,p=0;p<s.length&&(t.ugly_move(s[p]),u=Math.min(u,a(e-1,t,i,r,!n)),t.undo(),!((r=Math.min(r,u))<=i));p++);return u},_=function(e){for(var o=0,t=0;t<8;t++)for(var i=0;i<8;i++)o+=k(e[t][i],t,i);return o},u=function(e){return e.slice().reverse()},p=[[0,0,0,0,0,0,0,0],[5,5,5,5,5,5,5,5],[1,1,2,3,3,2,1,1],[.5,.5,1,2.5,2.5,1,.5,.5],[0,0,0,2,2,0,0,0],[.5,-.5,-1,0,0,-1,-.5,.5],[.5,1,1,-2,-2,1,1,.5],[0,0,0,0,0,0,0,0]],d=u(p),m=[[-5,-4,-3,-3,-3,-3,-4,-5],[-4,-2,0,0,0,0,-2,-4],[-3,0,1,1.5,1.5,1,0,-3],[-3,.5,1.5,2,2,1.5,.5,-3],[-3,0,1.5,2,2,1.5,0,-3],[-3,.5,1,1.5,1.5,1,.5,-3],[-4,-2,0,.5,.5,0,-2,-4],[-5,-4,-3,-3,-3,-3,-4,-5]],c=[[-2,-1,-1,-1,-1,-1,-1,-2],[-1,0,0,0,0,0,0,-1],[-1,0,.5,1,1,.5,0,-1],[-1,.5,.5,1,1,.5,.5,-1],[-1,0,1,1,1,1,0,-1],[-1,1,1,1,1,1,1,-1],[-1,.5,0,0,0,0,.5,-1],[-2,-1,-1,-1,-1,-1,-1,-2]],v=u(c),l=[[0,0,0,0,0,0,0,0],[.5,1,1,1,1,1,1,.5],[-.5,0,0,0,0,0,0,-.5],[-.5,0,0,0,0,0,0,-.5],[-.5,0,0,0,0,0,0,-.5],[-.5,0,0,0,0,0,0,-.5],[-.5,0,0,0,0,0,0,-.5],[0,0,0,.5,.5,0,0,0]],f=u(l),g=[[-2,-1,-1,-.5,-.5,-1,-1,-2],[-1,0,0,0,0,0,0,-1],[-1,0,.5,.5,.5,.5,0,-1],[-.5,0,.5,.5,.5,.5,0,-.5],[0,0,.5,.5,.5,.5,0,-.5],[-1,.5,.5,.5,.5,.5,0,-1],[-1,0,.5,0,0,0,0,-1],[-2,-1,-1,-.5,-.5,-1,-1,-2]],h=[[-3,-4,-4,-5,-5,-4,-4,-3],[-3,-4,-4,-5,-5,-4,-4,-3],[-3,-4,-4,-5,-5,-4,-4,-3],[-3,-4,-4,-5,-5,-4,-4,-3],[-2,-3,-3,-4,-4,-3,-3,-2],[-1,-2,-2,-2,-2,-2,-2,-1],[2,2,0,0,0,0,2,2],[2,3,1,0,0,1,3,2]],w=u(h),k=function(e,o,t){if(null===e)return 0;var i=function(e,o,t,i){if("p"===e.type)return 10+(o?p[i][t]:d[i][t]);if("r"===e.type)return 50+(o?l[i][t]:f[i][t]);if("n"===e.type)return 30+m[i][t];if("b"===e.type)return 30+(o?c[i][t]:v[i][t]);if("q"===e.type)return 90+g[i][t];if("k"===e.type)return 900+(o?h[i][t]:w[i][t]);throw"Unknown piece type: "+e.type}(e,"w"===e.color,o,t);return"w"===e.color?i:-i},b=function(e,o,i,r){if(!0===t.in_checkmate()||!0===t.in_draw()||-1!==o.search(/^b/))return!1},y=function(){var o=q(t);t.ugly_move(o),e.position(t.fen()),x(t.history()),t.game_over()&&scene(2)},C=function(){t.reset(),e.position("start","fast"),$("#history").empty(),selectedPiece=null,S()},q=function(e){if(e.game_over()&&scene(2),o=0,r=1,!0!==e.game_over()){1===r?n=100:2===r?n=600:3===r?n=1200:4===r?n=1600:5===r&&(n=1900);var t=r,i=new Date().getTime(),a=s(t,e,!0),_=new Date().getTime()-i,u=1e3*o/_;return $("#search-depth").text(r),$("#estimated-elo").text(n),$("#position-count").text(o),$("#time").text(_/1e3),$("#positions-per-s").text(Math.round(u)),a}},x=function(e){var o=$("#history").empty();o.empty();for(var t=0;t<e.length;t+=2)o.append("<span>"+(t/2+1)+". "+e[t]+" "+(e[t+1]?e[t+1]:" ")+"</span><br>");o.scrollTop(o[0].scrollHeight)},T=function(e,o){var i=t.move({from:e,to:o,promotion:"q"});if(S(),null===i)return"snapback";x(t.history()),window.setTimeout(y,250)},S=function(){$("#board .square-55d63").css("box-shadow",""),$("#board .square-55d63").css("background","")},M=function(e){var o=$("#board .square-"+e),t="inset 0px 0px 2vw 4vw var(--white-square)";o.hasClass("black-3c85d")&&(t="inset 0px 0px 2vw 4vw var(--black-square)"),o.css("box-shadow",t);var i=$("#board .square-"+e),r="rgba(66, 66, 66)";i.hasClass("black-3c85d")&&(r="rgba(66, 66, 66)"),i.css("background",r)},B=function(){e.position(t.fen())},D=function(e,o){var i=t.moves({square:e,verbose:!0});if(0!==i.length){M(e);for(var r=0;r<i.length;r++)M(i[r].to)}},H=function(e,o){S()},K={draggable:!0,pieceTheme:function(e){return i[e]},position:"start",onDragStart:b,onDrop:T,moveSpeed:"fast",onMouseoutSquare:H,onMouseoverSquare:D,onSnapEnd:B};e=ChessBoard("board",K)}catch(N){document.body.innerHTML=N}
